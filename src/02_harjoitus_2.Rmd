# ÖVNING 1.2: GEOSERVERS ANVÄNDARGRÄNSSNITT

**Övningens innehåll**

I övningen kommer vi att bekanta oss närmare med GeoServers huvudfunktioner genom användargränssnittet. Vi går igenom huvudmenyn och de viktigaste funktionerna i de olika delarna.

**Övningens syfte**

Efter övningen kommer du att förstå hur GeoServer fungerar och ha kunskap om de olika sektionernas verktyg.

**Tid**

35 minuter.

## **Förberedelser**

I den föregående övningen gick vi igenom några av menyerna i GeoServers. Användningen av dessa menyer och funktioner krävde ingen inloggning. I denna övning loggar vi in i GeoServers användargränssnitt som administratörer, vilket ger oss tillgång till fler menyer och funktioner.

## **Administratörens användargränssnitt**

Hittills har användargränssnittet endast visat öppna funktioner och data (utan inloggning). Dessa kan begränsas individuellt genom olika åtkomstkontrollinställningar. Vi kommer att bekanta oss med grunderna i åtkomstkontroll senare under kursen.

Logga in på servern som administratör med användaren **admin** och lösenordet **gispo**.

Administratörsvyn liknar den tidigare visade användargränssnittet. Den har samma struktur, men erbjuder betydligt fler funktioner och visningsalternativ.

GeoServers funktioner i huvudmenyn är grupperade efter deras användningsområden:

+--------------------------+----------------------------------------------------------------------------+
| ##### **About & Status** | Här finns allmän information om GeoServerinstallationen och dess status    |
+--------------------------+----------------------------------------------------------------------------+
| ##### **Data**           | Här laddar man upp data, hanterar lager och redigerar kartstilar 
+--------------------------+----------------------------------------------------------------------------+
| ##### **Services**       | Här kan du konfigurera olika geodatatjänster        
+--------------------------+----------------------------------------------------------------------------+
| ##### **Tile Caching**   | Här finns inställningar för GeoWebCache                                    
+--------------------------+----------------------------------------------------------------------------+
| ##### **Security**       | Här finns inställningar för åtkomsthantering                               
+--------------------------+----------------------------------------------------------------------------+
| ##### **Demos**          | Här finns Demo-funktioner för att testa GeoServer-tjänster                 
+--------------------------+----------------------------------------------------------------------------+
| ##### **Tools**          | Här finns extra verktyg                                         
+--------------------------+----------------------------------------------------------------------------+


Dessutom kan GeoServer-tillägg (extentions) lägga till menyer i användargränssnittet

I **Huvudmenyn** finns nu nya sektioner och verktyg 

De menyer vi nyligen gick igenom har också förändrats. De innehåller nu mer information och erbjuder möjlighet att redigera olika uppgifter och inställningar.

![](img/harjoitus_2/image1.png)

## **Master- och Administrator-användare**

GeoServers standardinstallation har två användarprofiler: **master** och **admin**. Lösenorden har ändrats från det förinställda värdet på följande vis:

**Master** →  gispogispo

**Admin** →   gispo

::: hint-box
Psst! Skillnaden mellan master- och admin-användare är att admin-användaren är avsedd för att användas vid hantering av webbgränssnittet. För att ändra serverinställningarna används master-användaren, som har behörighet att hantera GeoServers root-inställningar både direkt på servern och via webbgränssnittet. Undvik att använda dessa konton för underhåll av produktionsservrar.
:::

Man kan ändra lösenorden på dessa användare via åtkomsthanteringsverktyget i **Security**-sektionen.

## **About & Status -inställningar**

![](img/harjoitus_2/image2.png)

### **Contact Information**

Vi börjar med att uppdatera kontaktinformationen. Välj **About & Status → Contact Information** från huvudmenyn.

Fyll i med egna uppgifter, åtminstone följande fält: **Organization**, **Contact**, **Position** och **Email**.

![](img/harjoitus_2/image3.png)

För att återgå till **Welcome**-sidan kan du trycka på **GeoServer-loggan** uppe till vänster.

### **Server Status**

På **Server Status**-sidan finns information om olika GeoServer-inställningar och status. Observera till exempel platsen för **Data directory**-mappen.

Skriv ner platsen för din servers **Data directory** i dina anteckningar.

![](img/harjoitus_2/image4.png)

### **GeoServer Logs**

Genom att välja **GeoServer Logs** kan du visa serverns logg. 

![](img/harjoitus_2/image5.png)

## **Data-menyn**


Denna meny innehåller GeoServers viktigaste funktioner. Data läggs till och konfigureras med hjälp av dessa funktioner. Även förhandsgranskning av data sker genom de funktioner som finns här. Observera kopplingen mellan menyn och hur data är organiserade i bilden nedan.

![](img/harjoitus_2/image6.png)

Under **Styles** sektionen visuliserar man kartlagren (**Layers**) med hjälp av stilar. 

Stilar används varje gång lager publiceras som WMS-tjänster. Kartstilen är oberoende av lagren: samma kartstil kan användas på flera lager och varje lager kan ha flera valfria kartstilar.

### **Layer Preview**

Med den här menyn kan du förhandsgranska kartlager som publicerats på GeoServer.

I GeoServers standardinstallation finns några demonstrationslager som du omedelbart kan använda och förhandsgranska.

![](img/harjoitus_2/image7.png)

Ursprungsdatat för lagren kan vara raster eller vektor, och formaten beskrivs med följande ikoner:

 ![](img/harjoitus_2/image8.png) Raster

 ![](img/harjoitus_2/image9.png) Punkt (vektor)                                ![](img/harjoitus_2/image10.png) Polygon (vektor)

 ![](img/harjoitus_2/image11.png) Linje (vektor)                                  ![](img/harjoitus_2/image12.png) Lagergrupp


Förhandsgranskningen av lagret öppnas som en OpenLayers-karta i ett nytt webbläsarfönster. Observera att **OpenLayers**-förhandsgranskningen använder den visualiseringen som är förinställd på GeoServer. Visualiseringar kommer vi att utforska mer ingående senare.

Genom att använda rullgardinsmenyn (**Select one**) kan du också ladda ner det valda lagret i olika filformat (GeoTIFF, CSV, shapefile\...).

### **Workspaces**

**Workspace** (arbetsytor) är GeoServers system att organisera referenser till olika datakällor (**Stores**). Datafilerna är själva lagrade i en mapp (eller databas) som GeoServer har åtkomst till.

Ofta hålls liknande och/eller data från samma källa inom samma workspace. Till exempel kan en organisations data organiseras i workspaces baserat på teman som miljö, stadsplanering, befolkning, hälsa, etc.

Öppna **Workspaces**-sektionen, och du märker att det finns några workspaces där redan:

![](img/harjoitus_2/image13.png)

Tryck på **Add new workspace**.

Skapa ett nytt workspace, som vi använder oss av under kursen, ge den namnet **helsingborg** och skriv i rutan **Namespace URI**  följande [**http://gispo.se/geoserver/helsingborg**](http://gispo.se/geoserver/helsingborg):

![](img/harjoitus_2/image14.png)

Kryssa för **Default Workspace**, så kommer GeoServer att föreslå ditt nya workspace, då du lägger till nya datakällor och lager.

::: hint-box
Psst! URI (Uniform Resource Identifier) är en text som definierar namnet på en specifik resurs. Det kan vara en webbadress eller till och med en relativ sökväg på hårddisken. Det enda kravet är att URI
måste vara unik. Du kan till exempel hänvisa till en adress eller en mapp där dokumentation relaterad till workspacet är lagrad.
:::

Tryck på **Submit** för att skapa ditt nya workspace.

Öppna workspacet genom att trycka på**helsingborg** under **Workspace Name**. Observera, att det dykt upp fler inställningar. Vi återkommer senare till dem.

![](img/harjoitus_2/image15.png)

Återgå till **Workspace**-vyn genom att trycka på **Cancel**.

Man kan ta bort worspaces genom att välja en eller flera workspaces och trycka på **Remove selected workspace(s)**.

### **Stores**

Geoserverillä viitataan aineistolähteisiin **Storesien** avulla. Aineistolähteinä voivat olla yksittäiset tiedostot, tiedostoryhmät, hakemistot, tietokannat tai rajapintapalvelut.

Oletusasennuksessa on valmiina **Store**-viittauksia esimerkkiaineistoihin:

![](img/harjoitus_2/image16.png)

Jokaisen Storen vieressä on kuvake joka viittaa aineiston tyyppiin:

Tutustu muutamaan storen asetuksiin. Esimerkiksi **sfdem** viittaa rasteriaineistoon (huomaa kuvake) ja **taz_shapes** viittaa vektoriaineistoon.

![](img/harjoitus_2/image17.png)

Avaa sfdem-store ja taz_shapes-store. Kirjoita muistiinpanoihisi ylös vastaukset seuraaviin kysymyksiin:

::: hint-box
Mihin aineistoon sfdem-store viittaa?
:::

::: hint-box
Mihin aineistoon taz_shapes-store viittaa?
:::

Huomaa, että [**file:data/**](file:data/){.uri} viittaa Geoserverin Data Directory -hakemistoon. Hakemiston sijainti levyjärjestelmässä löytyy **About & Status → Server Status** -valikon kautta.

Store **taz_shapes** viittaa hakemistoon, jossa on useampia vektoriaineistoja, tässä tapauksessa .shp-tiedostoja.

Avaa vielä **taz_shapes**-store ja huomaa, että asetuksissa on rastittu **Enabled**. Se määrittää onko aineisto käytettävissä palvelimelta tai ei.

![](img/harjoitus_2/image18.png)

Toisin sanoen haluttaessa estää jonkin aineiston käyttöä GeoServerin kautta, ei tarvitse muuta kun jättää rastittamatta **Enabled**-valinta joko layer-, store- tai jopa workspace-valikossa.\

![](img/harjoitus_2/image19.png)

### **Layers**

Tasot (**Layers**) määrittelevät yhden aineistolähteen (**Store**) julkaisemisen ominaisuudet, kuten kuvaustekniikan, koordinaattijärjestelmän, metatiedot, palvelun ominaisuudet, karttatiilipalvelun (tile caching) määrittelyt jne.

Yksi taso vastaa yhtä aineistoa. Aineisto voidaan julkaista useisiin eri tasoihin, esimerkiksi eri kuvaustekniikoilla tms.

**Layers**-näkymässä on mahdollista muokata, lisätä tai poistaa tasoja. **Layers**-näkymän taulukossa on nähtävissä muutama taso ja niiden nimet (**Name**). Taulukossa lukee myös tason otsikko (**Title**) ja missä **Store**:ssa aineistot sijaitsevat.

Sarake **Enabled** näyttää tiedon siitä, onko taso käytettävissä palvelimelta vai ei. Huomaa, että käytettävyyden voi määritellä koko storelle (eli aineistolähteelle) tai erikseen tasoille (aineiston näkymille). Myös tason alkuperäinen koordinaattijärjestelmä on ilmoitettu taulukossa, **Native SRS**.

![](img/harjoitus_2/image20.png)

Avaa **Manhattan (NY) landmarks** -tason asetusten näkymä painamalla tason otsikkoa (**Title**) tai nimeä (**Name**) sarakkeesta. 

Tasoon liittyvät asetukset ovat laajat ja siksi ne on jaettu välilehtiin **Data**, **Publishing**, **Dimensions** ja **Tile Caching**. 

Tutustu nyt eri välilehtien asetuksiin saadaksesi kuvan siitä, miten tasot määritellään GeoServerillä. Keskustele niistä kouluttajan kanssa.

![](img/harjoitus_2/image21.png)

Tutustumme tarkemmin tasoasetuksiin myöhemmin, kun lisäämme omia aineistoja GeoServerille.

## **Layer Groups**

**Layer Groups** -toiminnolla muodostetaan tasoryhmiä. Tasoryhmien avulla on muodostetaan useammasta karttatasosta yhdistettyjä karttatasoja. Tasoryhmiin voidaan lisätä sekä karttatasoja että tasoryhmiä. Muun muassa tasojen järjestystä ja kuvaustekniikoita voidaan määrittää tasoryhmän asetuksissa.

## **Styles**

Avaa **Styles**-valikko, saat näkyviin listan GeoServerilla olevista kuvaustekniikoista.

![](img/harjoitus_2/image22.png)

Avaa **giant_polygon**-tyyli ja tutustu GeoServerin käyttämään kuvaustekniikkaformaattiin. Tasojen kuvaustekniikka määritellään käyttäen Styled Layer Descriptor (SLD) -kieltä.

![](img/harjoitus_2/image23.png)

Kuvaustekniikka on hyvin laaja aihe; siihen tutustutaan erikseen myöhemmin. Kuvaustekniikan toteuttamista voi helpottaa käyttämällä CSS-laajennosta, tätäkin käsitellään myöhemmin koulutuksessa.

## **Services**

GeoServerin rajapintapalvelujen (WFS, WMS ja WCS) yleisasetukset määritellään **Services**-valikon kautta; näihin tutustutaan tarkemmin myöhemmin.

![](img/harjoitus_2/image24.png)

## **Settings**

Tämä valikko sisältää erilaisia asetuksia kuten:

+--------------------------------------+-----------------------------------------------------------------------------+
| **Global**                           | Rajapintapalvelujen asetuksia ja lokitietojen asetuksia                     |
+--------------------------------------+-----------------------------------------------------------------------------+
| **Image Processing & Raster Access** | Asetukset kuvien ja raakakuva-aineiston (coverage) käsittelyyn palvelimessa |
+--------------------------------------+-----------------------------------------------------------------------------+

## **Tile Caching**

Tämän valikon kautta määritellään karttatiilipalvelujen (tile caching) asetuksia. Karttatiilipalveluihin tutustutaan tarkemmin myöhemmin.

![](img/harjoitus_2/image25.png)

## **Security**

Valikko sisältää GeoServerin pääsynhallintaan liittyvät asetukset. Huomaa, että muun muassa pääsynhallinta voidaan määrittää sekä käyttäjä-, ryhmä- ja roolikohtaisesti että aineisto- ja palvelukohtaisesti. Vilkaise nyt **Users**, **Groups, and Roles** -valikkoon.

![](img/harjoitus_2/image26.png)

Pääsynhallintaa käsitellään tarkemmin myöhemmin.
